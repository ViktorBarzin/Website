<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 340" width="960" height="340" font-family="sans-serif">
  <defs>
    <marker id="i1" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#6c7086"/>
    </marker>
    <marker id="i-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#89b4fa"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="960" height="340" rx="8" fill="#1e1e2e"/>

  <!-- Title -->
  <text x="480" y="28" fill="#cdd6f4" font-size="16" font-weight="bold" text-anchor="middle">Ingress Factory -- Middleware Pipeline</text>
  <text x="480" y="48" fill="#6c7086" font-size="11" text-anchor="middle">Applied to all 70+ services via one Terraform module</text>

  <!-- Request -->
  <rect x="20" y="100" width="90" height="60" rx="6" fill="#313244" stroke="#cdd6f4" stroke-width="1.5"/>
  <text x="65" y="128" fill="#cdd6f4" font-size="11" font-weight="bold" text-anchor="middle">Request</text>
  <text x="65" y="145" fill="#6c7086" font-size="8" text-anchor="middle">HTTPS</text>

  <!-- Arrow -->
  <line x1="110" y1="130" x2="130" y2="130" stroke="#6c7086" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Rate Limit -->
  <rect x="130" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#89b4fa" stroke-width="1.5"/>
  <text x="182" y="117" fill="#89b4fa" font-size="10" font-weight="bold" text-anchor="middle">Rate Limit</text>
  <text x="182" y="135" fill="#cdd6f4" font-size="9" text-anchor="middle">10 avg</text>
  <text x="182" y="150" fill="#cdd6f4" font-size="9" text-anchor="middle">50 burst</text>
  <text x="182" y="163" fill="#6c7086" font-size="8" text-anchor="middle">/second</text>

  <!-- Arrow -->
  <line x1="235" y1="130" x2="255" y2="130" stroke="#89b4fa" stroke-width="1.5" marker-end="url(#i-blue)"/>

  <!-- CrowdSec WAF -->
  <rect x="255" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#f38ba8" stroke-width="1.5"/>
  <text x="307" y="117" fill="#f38ba8" font-size="10" font-weight="bold" text-anchor="middle">CrowdSec</text>
  <text x="307" y="135" fill="#f38ba8" font-size="10" font-weight="bold" text-anchor="middle">WAF</text>
  <text x="307" y="152" fill="#cdd6f4" font-size="9" text-anchor="middle">Bouncer</text>
  <text x="307" y="163" fill="#6c7086" font-size="8" text-anchor="middle">IP reputation</text>

  <!-- Arrow -->
  <line x1="360" y1="130" x2="380" y2="130" stroke="#f38ba8" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Anti-AI Bot -->
  <rect x="380" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#fab387" stroke-width="1.5"/>
  <text x="432" y="117" fill="#fab387" font-size="10" font-weight="bold" text-anchor="middle">Anti-AI Bot</text>
  <text x="432" y="135" fill="#fab387" font-size="10" font-weight="bold" text-anchor="middle">Block</text>
  <text x="432" y="152" fill="#cdd6f4" font-size="9" text-anchor="middle">GPTBot, etc.</text>
  <text x="432" y="163" fill="#6c7086" font-size="8" text-anchor="middle">User-Agent filter</text>

  <!-- Arrow -->
  <line x1="485" y1="130" x2="505" y2="130" stroke="#fab387" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Authentik Auth -->
  <rect x="505" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#cba6f7" stroke-width="1.5"/>
  <text x="557" y="117" fill="#cba6f7" font-size="10" font-weight="bold" text-anchor="middle">Authentik</text>
  <text x="557" y="135" fill="#cba6f7" font-size="10" font-weight="bold" text-anchor="middle">SSO</text>
  <text x="557" y="152" fill="#cdd6f4" font-size="9" text-anchor="middle">ForwardAuth</text>
  <text x="557" y="163" fill="#6c7086" font-size="8" text-anchor="middle">OIDC / SAML</text>

  <!-- Arrow -->
  <line x1="610" y1="130" x2="630" y2="130" stroke="#cba6f7" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Security Headers -->
  <rect x="630" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#a6e3a1" stroke-width="1.5"/>
  <text x="682" y="117" fill="#a6e3a1" font-size="10" font-weight="bold" text-anchor="middle">Security</text>
  <text x="682" y="135" fill="#a6e3a1" font-size="10" font-weight="bold" text-anchor="middle">Headers</text>
  <text x="682" y="152" fill="#cdd6f4" font-size="9" text-anchor="middle">HSTS, CSP</text>
  <text x="682" y="163" fill="#6c7086" font-size="8" text-anchor="middle">X-Frame, etc.</text>

  <!-- Arrow -->
  <line x1="735" y1="130" x2="755" y2="130" stroke="#a6e3a1" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Rybbit Analytics -->
  <rect x="755" y="90" width="105" height="80" rx="6" fill="#313244" stroke="#f9e2af" stroke-width="1.5"/>
  <text x="807" y="117" fill="#f9e2af" font-size="10" font-weight="bold" text-anchor="middle">Rybbit</text>
  <text x="807" y="135" fill="#f9e2af" font-size="10" font-weight="bold" text-anchor="middle">Analytics</text>
  <text x="807" y="152" fill="#cdd6f4" font-size="9" text-anchor="middle">Script inject</text>
  <text x="807" y="163" fill="#6c7086" font-size="8" text-anchor="middle">Privacy-first</text>

  <!-- Arrow -->
  <line x1="860" y1="130" x2="880" y2="130" stroke="#f9e2af" stroke-width="1.5" marker-end="url(#i1)"/>

  <!-- Service -->
  <rect x="880" y="100" width="60" height="60" rx="6" fill="#313244" stroke="#a6e3a1" stroke-width="2"/>
  <text x="910" y="128" fill="#a6e3a1" font-size="10" font-weight="bold" text-anchor="middle">Your</text>
  <text x="910" y="145" fill="#a6e3a1" font-size="10" font-weight="bold" text-anchor="middle">Service</text>

  <!-- Bottom: Terraform module info -->
  <rect x="130" y="210" width="700" height="100" rx="8" fill="#313244" stroke="#6c7086" stroke-width="1"/>

  <text x="480" y="235" fill="#cdd6f4" font-size="12" font-weight="bold" text-anchor="middle">Terraform Module Usage</text>

  <text x="160" y="260" fill="#89b4fa" font-size="10" font-family="monospace">module "ingress" {</text>
  <text x="180" y="275" fill="#cdd6f4" font-size="10" font-family="monospace">source    = "../../modules/ingress-factory"</text>
  <text x="180" y="290" fill="#cdd6f4" font-size="10" font-family="monospace">hostname  = "app.viktorbarzin.me"</text>
  <text x="180" y="305" fill="#6c7086" font-size="10" font-family="monospace">// rate_limit, auth, headers all default ON</text>
  <text x="160" y="318" fill="#89b4fa" font-size="10" font-family="monospace">}</text>
</svg>