<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" width="900" height="520" font-family="sans-serif">
  <defs>
    <marker id="t1" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#666666"/>
    </marker>
    <marker id="t-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#4a90d9"/>
    </marker>
    <marker id="t-green" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#5cb85c"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="450" y="30" fill="#1a1a1a" font-size="16" font-weight="bold" text-anchor="middle">Terragrunt Project Structure</text>

  <!-- Root terragrunt.hcl -->
  <g data-label="Root terragrunt.hcl">
    <title>Root terragrunt.hcl - Provider, backend, and common variable configuration</title>
    <rect x="320" y="50" width="260" height="44" rx="6" fill="#fff3e0" stroke="#f0ad4e" stroke-width="2"/>
    <text x="450" y="70" fill="#8a6d3b" font-size="12" font-weight="bold" text-anchor="middle">terragrunt.hcl</text>
    <text x="450" y="86" fill="#555555" font-size="9" text-anchor="middle">Root config (provider, backend, common vars)</text>
  </g>

  <!-- terraform.tfvars -->
  <g data-label="terraform.tfvars">
    <title>terraform.tfvars - Variable values that feed into root config</title>
    <rect x="70" y="55" width="200" height="36" rx="6" fill="#e6f4ea" stroke="#5cb85c" stroke-width="1.5"/>
    <text x="170" y="78" fill="#2d6a2d" font-size="11" font-weight="bold" text-anchor="middle">terraform.tfvars</text>
  </g>
  <line x1="270" y1="73" x2="320" y2="73" stroke="#5cb85c" stroke-width="1.5" marker-end="url(#t-green)"/>
  <text x="295" y="67" fill="#555555" font-size="8">feeds</text>

  <!-- stacks/ directory -->
  <g data-label="stacks">
    <title>stacks/ - Directory containing all Terraform stack configurations</title>
    <rect x="320" y="120" width="260" height="36" rx="6" fill="#e8f0fe" stroke="#4a90d9" stroke-width="1.5"/>
    <text x="450" y="143" fill="#2c5ea0" font-size="12" font-weight="bold" text-anchor="middle">stacks/</text>
  </g>

  <!-- Arrow root -> stacks -->
  <line x1="450" y1="94" x2="450" y2="120" stroke="#666666" stroke-width="1.5" marker-end="url(#t1)"/>

  <!-- platform/ -->
  <g data-label="platform">
    <title>platform/ - Core infrastructure stacks (MetalLB, Traefik, cert-manager, Prometheus)</title>
    <rect x="50" y="185" width="180" height="36" rx="6" fill="#e8f0fe" stroke="#4a90d9" stroke-width="1.5"/>
    <text x="140" y="208" fill="#2c5ea0" font-size="11" font-weight="bold" text-anchor="middle">platform/</text>
  </g>
  <line x1="370" y1="156" x2="140" y2="185" stroke="#4a90d9" stroke-width="1" marker-end="url(#t-blue)"/>

  <!-- Platform services -->
  <g data-label="metallb">
    <title>metallb/ - MetalLB load balancer configuration</title>
    <rect x="10" y="240" width="130" height="30" rx="5" fill="#f5f5f5" stroke="#999999" stroke-width="1"/>
    <text x="75" y="260" fill="#333333" font-size="9" text-anchor="middle">metallb/</text>
  </g>
  <line x1="100" y1="221" x2="75" y2="240" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <g data-label="traefik">
    <title>traefik/ - Traefik ingress controller configuration</title>
    <rect x="150" y="240" width="130" height="30" rx="5" fill="#f5f5f5" stroke="#999999" stroke-width="1"/>
    <text x="215" y="260" fill="#333333" font-size="9" text-anchor="middle">traefik/</text>
  </g>
  <line x1="180" y1="221" x2="215" y2="240" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <g data-label="cert-manager">
    <title>cert-manager/ - TLS certificate management</title>
    <rect x="10" y="280" width="130" height="30" rx="5" fill="#f5f5f5" stroke="#999999" stroke-width="1"/>
    <text x="75" y="300" fill="#333333" font-size="9" text-anchor="middle">cert-manager/</text>
  </g>

  <g data-label="prometheus">
    <title>prometheus/ - Monitoring stack configuration</title>
    <rect x="150" y="280" width="130" height="30" rx="5" fill="#f5f5f5" stroke="#999999" stroke-width="1"/>
    <text x="215" y="300" fill="#333333" font-size="9" text-anchor="middle">prometheus/</text>
  </g>

  <!-- Individual service stacks -->
  <g data-label="grafana">
    <title>grafana/ - Grafana dashboard stack</title>
    <rect x="350" y="185" width="100" height="30" rx="5" fill="#fff3e0" stroke="#f0ad4e" stroke-width="1"/>
    <text x="400" y="205" fill="#333333" font-size="9" text-anchor="middle">grafana/</text>
  </g>
  <line x1="430" y1="156" x2="400" y2="185" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <g data-label="authentik">
    <title>authentik/ - Identity provider and SSO stack</title>
    <rect x="460" y="185" width="100" height="30" rx="5" fill="#fff3e0" stroke="#f0ad4e" stroke-width="1"/>
    <text x="510" y="205" fill="#333333" font-size="9" text-anchor="middle">authentik/</text>
  </g>
  <line x1="470" y1="156" x2="510" y2="185" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <g data-label="nextcloud">
    <title>nextcloud/ - Nextcloud file sharing stack</title>
    <rect x="570" y="185" width="100" height="30" rx="5" fill="#fff3e0" stroke="#f0ad4e" stroke-width="1"/>
    <text x="620" y="205" fill="#333333" font-size="9" text-anchor="middle">nextcloud/</text>
  </g>
  <line x1="510" y1="156" x2="620" y2="185" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <g data-label="more-stacks">
    <title>70+ additional service stacks</title>
    <rect x="680" y="185" width="100" height="30" rx="5" fill="#fff3e0" stroke="#f0ad4e" stroke-width="1"/>
    <text x="730" y="205" fill="#333333" font-size="9" text-anchor="middle">... (70+)</text>
  </g>
  <line x1="530" y1="156" x2="730" y2="185" stroke="#666666" stroke-width="1" marker-end="url(#t1)"/>

  <!-- Expanded stack anatomy -->
  <g data-label="Stack Anatomy">
    <title>Anatomy of each service stack - terragrunt.hcl, main.tf, secrets/, and shared module</title>
    <rect x="350" y="250" width="500" height="155" rx="8" fill="none" stroke="#999999" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="600" y="270" fill="#555555" font-size="11" font-weight="bold" text-anchor="middle">Stack Anatomy (each service)</text>
  </g>

  <!-- terragrunt.hcl -->
  <g data-label="Stack terragrunt.hcl">
    <title>Stack terragrunt.hcl - Includes root config and declares dependencies</title>
    <rect x="370" y="285" width="140" height="36" rx="5" fill="#fff3e0" stroke="#f0ad4e" stroke-width="1.5"/>
    <text x="440" y="300" fill="#8a6d3b" font-size="10" font-weight="bold" text-anchor="middle">terragrunt.hcl</text>
    <text x="440" y="314" fill="#555555" font-size="8" text-anchor="middle">include root + deps</text>
  </g>

  <!-- main.tf -->
  <g data-label="main.tf">
    <title>main.tf - Helm releases and Kubernetes resource definitions</title>
    <rect x="530" y="285" width="140" height="36" rx="5" fill="#e8f0fe" stroke="#4a90d9" stroke-width="1.5"/>
    <text x="600" y="300" fill="#2c5ea0" font-size="10" font-weight="bold" text-anchor="middle">main.tf</text>
    <text x="600" y="314" fill="#555555" font-size="8" text-anchor="middle">helm + k8s resources</text>
  </g>

  <!-- secrets/ symlink -->
  <g data-label="secrets">
    <title>secrets/ - Symlinked secrets encrypted with git-crypt</title>
    <rect x="690" y="285" width="140" height="36" rx="5" fill="#fce4ec" stroke="#d9534f" stroke-width="1.5"/>
    <text x="760" y="300" fill="#a94442" font-size="10" font-weight="bold" text-anchor="middle">secrets/</text>
    <text x="760" y="314" fill="#555555" font-size="8" text-anchor="middle">symlink (git-crypt)</text>
  </g>

  <!-- ingress-factory module -->
  <g data-label="ingress-factory module">
    <title>Shared ingress_factory module - Traefik IngressRoute with middlewares and certificates</title>
    <rect x="370" y="345" width="300" height="36" rx="5" fill="#e6f4ea" stroke="#5cb85c" stroke-width="1.5"/>
    <text x="520" y="360" fill="#2d6a2d" font-size="10" font-weight="bold" text-anchor="middle">module "ingress_factory" (shared)</text>
    <text x="520" y="376" fill="#555555" font-size="8" text-anchor="middle">Traefik IngressRoute + middlewares + cert</text>
  </g>
  <line x1="600" y1="321" x2="520" y2="345" stroke="#5cb85c" stroke-width="1" marker-end="url(#t-green)"/>

  <!-- State files -->
  <g data-label="State Files">
    <title>State isolation - One local state file per stack for isolated blast radius</title>
    <rect x="220" y="440" width="460" height="50" rx="6" fill="#f5f5f5" stroke="#999999" stroke-width="1.5"/>
    <text x="450" y="460" fill="#333333" font-size="11" font-weight="bold" text-anchor="middle">State: state/stacks/{service}/terraform.tfstate</text>
    <text x="450" y="478" fill="#555555" font-size="9" text-anchor="middle">Local backend -- one state file per stack -- isolated blast radius</text>
  </g>

  <!-- Arrow from stacks to state -->
  <line x1="450" y1="405" x2="450" y2="440" stroke="#666666" stroke-width="1.5" marker-end="url(#t1)"/>
  <text x="480" y="428" fill="#555555" font-size="9">state output</text>
</svg>